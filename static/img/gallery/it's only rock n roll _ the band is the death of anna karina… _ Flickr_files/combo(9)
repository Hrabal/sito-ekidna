YUI.add("flickr-photosets-removePhoto-deletor",function(e,t){"use strict";function n(n,r){var i={full_response:1},s=[],o=n.isMultiplePhotos?"photo_ids":"photo_id",u=n.photoID.split(",").length;return i[o]=n.photoID,i.photoset_id=n.setID,s=[r.callAPI("flickr.photosets.removePhoto",i),r.getModel("set-models",n.setID),r.getModel("sets-models",r.getViewer().nsid,{page:1,perPage:r.flipper.isFlipped("enable-sets-list-loading-fix")?10:500}),r.getModelRegistry("photo-sets-models"),r.getModelRegistry("photo-contexts-models")],n.isMultiplePhotos||s.push(r.getModel("photo-models",n.photoID)),e.Promise.all(s).then(function(e){var t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a;if(t.stat==="ok"){o.exists(n.photoID)&&o.getValue(n.photoID,"contexts").getFromListByID(n.setID)&&(o.setValue(n.photoID,"totalSets",o.getValue(n.photoID,"totalSets")-u),o.getValue(n.photoID,"contexts").removeFromList(n.setID)),s.exists(n.photoID)&&s.getValue(n.photoID,"sets").getFromListByID(n.setID)&&(s.setValue(n.photoID,"total",s.getValue(n.photoID,"total")-u),s.getValue(n.photoID,"sets").removeFromList(n.setID));if(r){n.isMultiplePhotos?r&&n.updateItemCounts&&(r.setValue("photoCount",r.getValue("photoCount")-n.numberOfPhotosSelected),r.setValue("videoCount",r.getValue("videoCount")-n.numberOfVideosSelected)):(a=e[5],r.hasPhoto(a.getValue("id"))&&r.removePhoto(a),a.getValue("isVideo")?r.setValue("videoCount",r.getValue("videoCount")-u):r.setValue("photoCount",r.getValue("photoCount")-u));if(r.getValue("totalCount")<1)return i.getValue("albumsList").remove(n.setID),r.registry.remove(n.setID),null}return r}},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-photosets-removePhoto"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:["set-models","photo-models","sets-models","photo-sets-models","photo-contexts-models"]});
YUI.add("flickr-photosets-delete-deletor",function(e,t){"use strict";function n(n,r){return n.photoset_id=n.setID,n.gpCode&&(n.gp_code=n.gpCode),n.gpOwner&&(n.gp_owner=n.gpOwner),n.shareCode&&(n.share_code=n.shareCode),r.callAPI("flickr.photosets.delete",n).then(function(e){if(e.code===1)throw new Error(e)}).catch(e.FetcherErrorLogger(t))}e.namespace("ModelDeletors")["flickr-photosets-delete-deletor"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-photosets-getPhotos-fetcher",function(e,t){"use strict";function n(t){t.page=t.page||1,t.perPage=t.perPage||100;var n={extras:e.APIHelper.request.getRebootPhotoExtras(),per_page:t.perPage,page:t.page,get_user_info:1,primary_photo_extras:"url_c, url_h, url_k, url_l, url_m, url_n, url_o, url_q, url_s, url_sq, url_t, url_z, needs_interstitial, can_share",jump_to:t.withPhotoId||""};return t.gpCode&&t.gpCode!==null?(n.gp_code=t.gpCode,n.share_code=t.gpCode,n.gp_owner=t.gpOwner):n.photoset_id=t.id.split("-")[0],t.viewAs&&(n.view_as=t.viewAs),t.filter&&(n.privacy_filter=t.filter),n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l,c,h,p,d,v=[],m=!1,g=!1,y=n.id;l=e.APIHelper.response.parsePerson(r.user),c=s.addOrUpdate(l),h={id:n.id,title:r.photoset.title,description:r.photoset.description,owner:c,primary:r.photoset.primary,primaryPhotoSizes:e.APIHelper.response.parsePrimaryPhotoSizes(r.photoset),isAutoUploadSet:r.photoset.isAutoUploadSet,isSharedEntity:r.photoset.hidden&&r.photoset.hidden===1,photoCount:r.photoset.photoCount,videoCount:r.photoset.videoCount,primaryNeedsInterstitial:r.photoset.needsInterstitial,totalCount:parseInt(r.photoset.photoCount,10)+parseInt(r.photoset.videoCount,10),photoList:[],viewCount:r.photoset.countViews,canShare:r.photoset.canShare,canDownload:r.photoset.canDownload},y&&y!==r.photoset.id&&(h.id=y),r.photoset.isAutoUploadSet==="1"&&(h.canShare=!1),o.exists(n.id)&&(p=o.getValue(n.id,"photoPageList"),m=p.hasMinBoundary?p.hasMinBoundary():!1,g=p.hasMaxBoundary?p.hasMaxBoundary():!1,v=p.getList()),d=e.APIHelper.response.parsePhotos({photos:r.photoset.photo,ownerID:r.photoset.owner,personModelRegistry:s,photoModelRegistry:i,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),h.photoPageList=e.APIHelper.response.addOrReplaceListByPage({current:v,perPage:n.perPage,pageNum:n.page,hasMax:g,hasMin:m,totalItems:r.photoset.total,newPages:d}),h.photoPageList={perPage:r.photoset.perPage,page:r.photoset.page,pageContent:d,totalItems:r.photoset.total},h.photoList.length&&(h.primary=r.photoset.primary);var b={id:h.id,countPhotosFamily:r.photoset.countPhotosFamily,countPhotosFriend:r.photoset.countPhotosFriend,countPhotosPublic:r.photoset.countPhotosPublic,countPhotosFriendFamily:r.photoset.countPhotosFriendFamily,totalCount:r.photoset.countPhotosAll};return f.exists(b.id)?f.setValues(n.id,b):f.add(b),o.exists(h.id)?o.setValue(n.id,"photoPageList",h.photoPageList):o.add(h),d}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.photosets.getPhotos",this._processParams(n),!0),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("set-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("album-privacy-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-photosets-getPhotos"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-models","person-models","set-models","photo-engagement-models","photo-stats-models"]});
YUI.add("flickr-photosets-getContext-fetcher",function(e,t){"use strict";function n(t,n){var r={extras:e.APIHelper.request.getRebootPhotoExtras(),photo_id:t.photoId,num_prev:t.numNext,num_next:t.numPrev,get_photoset_info:1};return t.gpCode?(r.share_code=t.gpCode,r.share_owner=t.gpOwner,r.gp_code=t.gpCode,r.gp_owner=t.gpOwner):r.photoset_id=t.id,r}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=[],l=[],c=s.proxy(n.photoId),h,p,d,v,m,g,y=[];return h=r.prevphotos,p=r.nextphotos,l=e.APIHelper.response.parsePhotos({photos:h.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),f=e.APIHelper.response.parsePhotos({photos:p.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),m=i.getValue(n.id,"photoContextList"),d=m.hasMinBoundary?m.hasMinBoundary():!1,v=m.hasMaxBoundary?m.hasMaxBoundary():!1,g=m.getList(),y=e.APIHelper.response.addOrReplaceListByContext({model:c,next:l,prev:f.reverse(),current:g,hasMin:d,hasMax:v,numNext:n.numNext,numPrev:n.numPrev}),i.setValue(n.id,"photoContextList",y),{next:l,previous:f.reverse()}}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.photosets.getContext",this._processParams(n,r),!0),r.getModelRegistry("set-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models")]).then(function(e){return i._processResponse(e,n)},function(e){throw e.code===2&&e.message==="Photo not in set"&&(e.notInContext=!0),e}).then(null,e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-photosets-getContext"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["set-models","photo-models","person-models","photo-engagement-models","photo-stats-models"]});
YUI.add("flickr-photosets-create-creator",function(e,t){"use strict";function n(n,r){var i={},s=[];return i.title=n.title,i.description=n.description,i.primary_photo_id=n.photoID,i.full_result=1,s=[r.callAPI("flickr.photosets.create",i),r.getModelRegistry("set-models"),r.getModel("person-models",r.getViewer().nsid),r.getModel("sets-models",r.getViewer().nsid,{page:1,perPage:r.flipper.isFlipped("enable-sets-list-loading-fix")?10:500}),r.getModelRegistry("photo-sets-models"),r.getModelRegistry("photo-contexts-models")],n.isMultiplePhotos||s.push(r.getModel("photo-models",n.photoID)),e.Promise.all(s).then(function(t){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f,l,c,h,p,d=1;return r.photoset.id?(n.isMultiplePhotos?n.numberOfPhotosSelected+n.numberOfVideosSelected===1?(h=r.photoset.photos,p=r.photoset.videos):r.photoset.photos?(h=r.photoset.photos,p=0):(p=r.photoset.videos,h=0):(l=t[6],h=r.photoset.photos,p=r.photoset.videos),f={id:r.photoset.id,title:r.photoset.title.content,photoPageList:n.isMultiplePhotos?[]:[l],photoContextList:n.isMultiplePhotos?[]:[l],owner:s,primary:r.photoset.primary,primaryPhotoSizes:e.APIHelper.response.parsePrimaryPhotoSizes(r.photoset),isAutoUploadSet:!1,photoCount:h,videoCount:p,totalCount:d,viewCount:r.countViews||0},i.add(f),c=i.proxy(r.photoset.id),o.getValue("albumsList").unshift(c),u.exists(n.photoID)&&!u.getValue(n.photoID,"sets").getFromListByID(c.getValue("id"))&&(u.getValue(n.photoID,"sets").prependToList(c),u.setValue(n.photoID,"total",u.getValue(n.photoID,"total")+1)),a.exists(n.photoID)&&!a.getValue(n.photoID,"contexts").getFromListByID(c.getValue("id"))&&(a.setValue(n.photoID,"totalSets",a.getValue(n.photoID,"totalSets")+1),a.getValue(n.photoID,"contexts").appendToList(c)),c):!1},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-photosets-create"]={run:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["set-models","photo-models","person-models","sets-models","photo-sets-models","photo-contexts-models"]});
YUI.add("flickr-photosets-createHidden-creator",function(e,t){"use strict";function n(n,r){var i={},s=[];return i.photo_ids=n.photoIds,s=[r.callAPI("flickr.photosets.createHidden",i),r.getModelRegistry("set-models"),r.getModel("person-models",r.getViewer().nsid)],e.Promise.all(s).then(function(e){var t=e[0],n=e[1],r=e[2],i,s;return t.stat==="ok"&&t.photoset.share_code?(i={id:t.photoset.share_code,shareCode:t.photoset.share_code,owner:r,gpCode:t.photoset.share_code,gpOwner:r.getValue("pathAlias")||r.getValue("nsid"),url:t.photoset.url,isAutoUploadSet:!1,isSharedEntity:!0,totalCount:t.photoset.count},n.add(i),s=n.proxy(i.id),s):!1},e.FetcherErrorLogger(t))}e.namespace("ModelCreators")["flickr-photosets-createHidden"]={run:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["set-models","photo-models","person-models","sets-models","photo-sets-models","photo-contexts-models"]});
YUI.add("flickr-photosets-editMeta-updater",function(e,t){"use strict";function r(e,t,r){var i=e[0],s=e[1];if(!i.photoset||!i.photoset.title||!i.photoset.description)n.warn("No updated data returned from API.");else{if(!s.exists(t.photosetId))throw new Error("[flickr-photosets-editMeta-updater] - Set model cannot be updated if it does not exist");s.setValues(t.photosetId,{title:i.photoset.title.content,description:i.photoset.description.content})}}function i(n,r){var i={},s=this;return i.photoset_id=n.photosetId,i.title=n.title,i.description=n.description,e.Promise.all([r.callAPI("flickr.photosets.editMeta",i),r.getModelRegistry("set-models")]).then(function(e){s._processResponse(e,n,r)},e.FetcherErrorLogger(t))}var n=require("lib/flog")(t);e.namespace("ModelUpdaters")["flickr-photosets-editMeta"]={run:i,_processResponse:r}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("flickr-photosets-setPrimaryPhoto-updater",function(e,t){"use strict";function n(n,r){var i={};return i.photoset_id=n.albumId,i.photo_id=n.photoId,r.callAPI("flickr.photosets.setPrimaryPhoto",i).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-photosets-setPrimaryPhoto"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("set-models",function(e,t){function r(e){r.superclass.constructor.call(this,e)}var n=require("lib/flog")(t);e.Models[this.name]=r,e.extend(r,e.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-photosets-getPhotos"].run(t,this.appContext)},create:function(t,n){return e.ModelCreators["flickr-photosets-create"].run(t,n)},createHidden:function(t,n){return e.ModelCreators["flickr-photosets-createHidden"].run(t,n)},addPhoto:function(t,n){return e.ModelCreators["flickr-photosets-addPhoto"].run(t,n)},removePhoto:function(t,n){return e.ModelCreators["flickr-photosets-removePhoto"].run(t,n)},update:function(t,n){return e.ModelUpdaters["flickr-photosets-editMeta"].run({photosetId:t,title:n.title?n.title.newVal:this.getValue(t,"title"),description:n.description?n.description.newVal:this.getValue(t,"description")},this.appContext)},setPrimaryPhoto:function(t,n){return e.ModelUpdaters["flickr-photosets-setPrimaryPhoto"].run(t,n)},"delete":function(t){if(typeof t=="string"){var n=t;t={setID:n}}return e.ModelDeletors["flickr-photosets-delete-deletor"].run(t,this.appContext)}},addPhoto:function(e,t){return this.getValue(e,"photoPageList").hasMaxBoundary()&&this.getValue(e,"photoPageList").appendToList(t),this.getValue(e,"photoContextList").hasMaxBoundary()&&this.getValue(e,"photoContextList").appendToList(t),this},removePhoto:function(e,t){return this.getValue(e,"photoPageList").removeFromList(t.getValue("id")),this.getValue(e,"photoContextList").removeFromList(t.getValue("id")),this},hasPhoto:function(e,t){return this.getValue(e,"photoPageList").getFromListByID(t)||this.getValue(e,"photoContextList").getFromListByID(t)},getSizeToFit:function(t,r,i){n.warn("Using `getSizeToFit` is deprecated. See model comments for more details.");var s=e.PhotoModelHelper.getSizeToFit(t,r,e.merge({sizes:this.getValue(t,"primaryPhotoSizes"),includeSquare:!0,cropToFit:!0},i));return s&&(s.url=s.src),s},getLargestPrimaryPhotoSize:function(t,n){return e.PhotoModelHelper.getLargestSize(t,n)},attributes:{normalizedId:{readOnly:!0,defaultFn:function(e){return e.split("-")[0]}},displayType:{readOnly:!0,defaultFn:function(){return"set"}},title:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},description:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)},defaultValue:""},owner:{isModel:!0},isOwner:e.PhotoModelHelper.attributes.isOwner,photoPageList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-photosets-getPhotos"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-photosets-getContext"],listItemIdField:"photoId"}},photoCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},videoCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},totalCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultFn:function(e){return this.getValue(e,"photoCount")+this.getValue(e,"videoCount")}},viewCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},photoCountDisplay:{readOnly:!0,derivedBy:["totalCount"],defaultFn:function(e){var t=this.getValue(e,"photoCount"),n=this.getValue(e,"videoCount"),r=this.getValue(e,"totalCount"),i="";return t-=n,t===0&&n===0?i=this.intlMessage({intlName:"models.ZERO_PHOTOS"}):t===1&&n===0?i=this.intlMessage({intlName:"models.ONE_PHOTO"}):t>1&&n===0?i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS",photos:t}):t===0&&n===1?i=this.intlMessage({intlName:"models.ONE_VIDEO"}):t===1&&n===1?i=this.intlMessage({intlName:"models.ONE_PHOTO_AND_ONE_VIDEO"}):t>1&&n===1?i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_ONE_VIDEO",photos:t}):t===0&&n>1?i=this.intlMessage({intlName:"models.MULTIPLE_VIDEOS",videos:n}):t===1&&n>1?i=this.intlMessage({intlName:"models.ONE_PHOTO_AND_MULTIPLE_VIDEOS",videos:n}):t>1&&n>1&&(i=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS",photos:t,videos:n})),r===0?i=this.intlMessage({intlName:"models.ZERO_ITEMS"}):r===1?i=this.intlMessage({intlName:"models.ONE_ITEM"}):r>1&&(i=this.intlMessage({intlName:"models.MULTIPLE_ITEMS",items:r})),i}},photoAndVideosDisplay:{readOnly:!0,derivedBy:["photoCount","videoCount"],defaultFn:function(e){var t=this.getValue(e,"photoCount"),n=this.getValue(e,"videoCount"),r="";return t===0&&n===0?r=this.intlMessage({intlName:"models.ZERO_PHOTOS"}):t===1&&n===0?r=this.intlMessage({intlName:"models.ONE_PHOTO"}):t>1&&n===0?r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS",photos:t}):t===0&&n===1?r=this.intlMessage({intlName:"models.ONE_VIDEO"}):t===1&&n===1?r=this.intlMessage({intlName:"models.ONE_PHOTO_AND_ONE_VIDEO"}):t>1&&n===1?r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_ONE_VIDEO",photos:t}):t===0&&n>1?r=this.intlMessage({intlName:"models.MULTIPLE_VIDEOS",videos:n}):t===1&&n>1?r=this.intlMessage({intlName:"models.ONE_PHOTO_AND_MULTIPLE_VIDEOS",videos:n}):t>1&&n>1&&(r=this.intlMessage({intlName:"models.MULTIPLE_PHOTOS_AND_MULTIPLE_VIDEOS",photos:t,videos:n})),r}},sharedEntityDisplay:{readOnly:!0,derivedBy:["videoCount","photoCount"],defaultFn:function(e){var t=this.getValue(e,"photoCount"),n=this.getValue(e,"videoCount"),r=this.getValue(e,"owner"),i="";return t&&!n?i=this.intlMessage({intlName:"shared-entity.USERNAME_HAS_SHARED_PHOTOS_ONLY",username:r.getValue("displayname"),photoCount:parseInt(t,10)}):!t&&n?i=this.intlMessage({intlName:"shared-entity.USERNAME_HAS_SHARED_VIDEOS_ONLY",username:r.getValue("displayname"),videoCount:parseInt(n,10)}):t&&n&&(i=this.intlMessage({intlName:"shared-entity.USERNAME_HAS_SHARED_PHOTOS_VIDEOS"
,username:r.getValue("displayname"),photoCount:parseInt(t,10),videoCount:parseInt(n,10)})),i}},primary:{},primaryPhotoSizes:{},primaryNeedsInterstitial:{},bestIconURL:{readOnly:!0,derivedBy:["primaryPhotoSizes"],defaultFn:function(t){var n=e.PhotoModelHelper.getSizeToFit(t,{height:48,width:48},e.merge({sizes:this.getValue(t,"primaryPhotoSizes"),includeSquare:!0,cropToFit:!0}));return n?n.src:""}},url:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.getValue(e,"owner"),n=this.getValue(e,"isSharedEntity"),r=this.getValue(e,"normalizedId");return t&&n===!0?"/photos/"+t.getValue("pathAlias")+"/shares/"+r:t?"/photos/"+t.getValue("pathAlias")+"/albums/"+r:undefined}},isAutoUploadSet:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isSharedEntity:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},canShare:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},canDownload:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},urlSuffix:{readOnly:!0,defaultFn:function(e){var t=this.getValue(e,"isSharedEntity");return t?"shares-"+e:"album-"+e}},gpCode:{defaultFn:function(e){return null}},gpOwner:{defaultFn:function(e){return null}}}},{buildCompoundId:function(e,t,n){var r=e;return t&&(r+="-"+t),n&&(t||(r+="-dateposted"),r+="-"+n),r},splitCompoundId:function(e){var t=e.split("-");return{nsid:t[0],orderBy:t[1],viewAs:t[2]}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photosets-addPhoto-creator","flickr-photosets-removePhoto-deletor","flickr-photosets-delete-deletor","flickr-photosets-getPhotos-fetcher","flickr-photosets-getContext-fetcher","flickr-photosets-create-creator","flickr-photosets-createHidden-creator","flickr-photosets-editMeta-updater","flickr-photosets-setPrimaryPhoto-updater","photo-model-helper"],langBundles:["models","shared-entity"]});
YUI.add("photo-groups-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-photos-getAllContexts"].run(t,this.appContext)}},attributes:{id:{},groups:{isCollection:!0},total:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0}}})},"@VERSION@",{requires:["api-helper","flickr-model-registry","flickr-promise","flickr-photos-getAllContexts-fetcher"]});
YUI.add("flickr-photos-getAllContexts-fetcher",function(e,t){"use strict";function n(t){var n;return n={photo_id:t.id,extras:e.APIHelper.request.getRebootPhotoExtras()+","+e.APIHelper.request.getRebootGroupExtras()+","+e.APIHelper.request.getRebootAlbumsListExtras(),primary_photo_extras:"url_sq, url_t, url_s, url_m, needs_interstitial"},t.scrappy&&(n.get_all_galleries=1,n.no_faves_context=1,n.per_type_limit=6,n.get_totals=1,n.sort="date-desc"),n}function r(t,n){var r=t[0],i=t[1],s=t[2],o={},u=[],a,f=t[8],l=t[9],c=t[10],h=t[11],p;return o.faves=t[3],o.gallery=t[4],o.pool=t[5],o.set=t[6],o.stream=t[7],e.Object.each(o,function(t,n){r[n]&&e.Array.each(r[n],function(n){e.APIHelper.response.addContextToRegistry(n,t,i,h),u.push(t.proxy(n.id))})}),s.exists(n.id)||(a=s.add({id:n.id,totalGroups:r.totals&&r.totals.groups,totalSets:r.totals&&r.totals.sets,totalGalleries:r.totals&&r.totals.galleries}),s.setValue(n.id,"contexts",u)),f.addOrUpdate({id:n.id,total:r.totals&&r.totals.groups,groups:s.getContextsOfType(n.id,"group-pool-models")}),p=s.getContextsOfType(n.id,"set-models"),p.forEach(function(e){e.setValue("totalCount",parseInt(e.getValue("photoCount"),10)+parseInt(e.getValue("videoCount"),10))}),l.addOrUpdate({id:n.id,total:r.totals&&r.totals.sets,sets:p}),c.addOrUpdate({id:n.id,total:r.totals&&r.totals.galleries,galleries:s.getContextsOfType(n.id,"gallery-models")}),a}function i(n,r){var i=this;return r.flipper.isFlipped("enable-scrappy-photo-page")&&(n.scrappy=!0),e.Promise.all([r.callAPI("flickr.photos.getAllContexts",this._processParams(n),!0),r.getModelRegistry("person-models"),r.getModelRegistry("photo-contexts-models"),r.getModelRegistry("favorite-models"),r.getModelRegistry("gallery-models"),r.getModelRegistry("group-pool-models"),r.getModelRegistry("set-models"),r.getModelRegistry("photostream-models"),r.getModelRegistry("photo-groups-models"),r.getModelRegistry("photo-sets-models"),r.getModelRegistry("photo-galleries-models"),r.getModelRegistry("group-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-photos-getAllContexts"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-contexts-models","favorite-models","gallery-models","group-pool-models","photostream-models","set-models","photo-groups-models","photo-sets-models","photo-galleries-models","group-models"]});
YUI.add("photo-contexts-models",function(e){function t(e){t.superclass.constructor.call(this,e),this.getMorePromises={"group-pool-models":{},"set-models":{},"gallery-models":{}},this.continuationKeys={"group-pool-models":{},"set-models":{},"gallery-models":{}}}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return this.appContext.flipper.isFlipped("enable-scrappy-photo-page")?e.ModelFetchers["flickr-photos-getAllContexts"].run(t,this.appContext):e.ModelFetchers["flickr-photos-getInfo"].run(t,this.appContext)}},getMoreContextsOfType:function(t,n,r){var i=this,s,o,u,a,f,l,c,h="-1",p=e.APIHelper.request.getRebootPhotoExtras();switch(n){case"group-pool-models":s="flickr.photos.getGroups",u="groups.group",p+=","+e.APIHelper.request.getRebootGroupExtras();break;case"set-models":s="flickr.photos.getSets",u="sets.set";break;case"gallery-models":s="flickr.photos.getGalleries",u="galleries.gallery"}return s?this.exists(t)?(a=this.continuationKeys[n][t]||"0",a===h?e.Promise.resolve({type:n,newContexts:[],loadedAll:!0}):(o={photo_id:t,extras:p,primary_photo_extras:"url_sq, url_t, url_s, url_m",continuation:a,per_page:r},l=t+"_"+a,c=this.getMorePromises[n][l],c?c:(this.getMorePromises[n][l]=(new e.FlickrPromise({apiResponse:this.appContext.callAPI(s,o,!0),contextRegistry:this.appContext.getModelRegistry(n),personRegistry:this.appContext.getModelRegistry("person-models")})).then(function(r){var s=[],o=r.apiResponse,a=r.contextRegistry,c=r.personRegistry,p,d,v;return d=u.split(".").reduce(function(t,n){return e.Lang.isObject(t)?t[n]:undefined},o),d&&(e.Array.each(d,function(t){e.APIHelper.response.addContextToRegistry(t,a,c),s.push(a.proxy(t.id))}),s.length&&(v=i.getContextsOfType(t,n).map(function(e){return e.getValue("id")}),s=s.filter(function(e){return v.indexOf(e.getValue("id"))===-1}),s.length&&i.getValue(t,"contexts").appendToListMulti(s))),f=o.continuation,typeof f=="undefined"?f=h:e.Lang.isNumber(f)&&(f+=""),p=f===h,i.continuationKeys[n][t]=f,delete i.getMorePromises[n][l],{type:n,newContexts:s,loadedAll:p}}),this.getMorePromises[n][l]))):e.Promise.reject("[photo-contexts-models] getMoreContextsOfType was called for an ID that isn't in the registry: "+t):e.Promise.reject("[photo-contexts-models] getMoreContextsOfType was called without an invalid type: "+n)},getContextsOfType:function(t,n){return n=e.Array(n),this.getValue(t,"contexts").getList().filter(function(e){return n.indexOf(e.registry.name)>-1})},getContextsNotOfType:function(t,n){return n=e.Array(n),this.getValue(t,"contexts").getList().filter(function(e){return n.indexOf(e.registry.name)===-1})},attributes:{contexts:{isCollection:!0},totalGroups:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},totalSets:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},totalGalleries:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0}}})},"@VERSION@",{requires:["api-helper","flickr-model-registry","flickr-promise","flickr-photos-getInfo-fetcher","flickr-photos-getAllContexts-fetcher"]});
YUI.add("vr-overlay-view",function(e,t){var n=require("lib/flog")(t),r;r={css:{destinationContainer:"body",closeX:".close"},options:{}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.photoId=e.photoId,this.nsid=e.nsid,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this.immersed=!1,this},subviewConfig:{},loadState:function(){var e=this;return this.appContext.getModel("photo-models",e.photoId).then(function(t){return e.set("photo",t),e.canVr().then(function(t){e.set("canVr",t)})})},buildContainer:function(){var e=this.get("canVr");return this.set("isActiveViewAgnostic",!0),e?(this.setContainerWithTemplate("vr-overlay"),this):this},buildErrorContainer:function(){this.setContainerHTML("")},activate:function(){var t=this;if(!this.get("canVr"))return;return this.loadFlickvr().then(function(){var n=t.get("container");n.addClass("active"),n.one(r.css.closeX)&&t.registerEventHandler(n.one(r.css.closeX).on("click",e.bind(t.closeVr,t))),t.registerEventHandler(t.get("container").on("click",t.openVr,t)),t.isMobile||t.openVr()}).then(null,function(e){n.error("Failed to load flickvr from CDN",{err:e})}),this},loadFlickvr:function(){return new e.Promise(function(t,r){if(window.Flickvr)return t();e.Get.js("https://s.yimg.com/uy/flickvr/version.js",function(i){if(i)return r();if(!window.FlickvrVersion)return r();e.Get.js("https://s.yimg.com/uy/flickvr/"+window.FlickvrVersion+".js",function(e){return e?r():(n.log("flickvr loaded successfully from CDN"),t())})})})},hasEquirectangularTag:function(){return this.appContext.getModel("photo-tags-models",this.photoId).then(function(e){var t=!1,n=e.toJSON();return n.tags.forEach(function(e){var n=e.tagRaw.toLowerCase();n==="equirectangular"&&(t=!0)}),t})},inEquirectangularGroup:function(){return this.appContext.getModel("photo-groups-models",this.photoId).then(function(e){var t=!1,n=e.toJSON();return n.groups.forEach(function(e){e.id==="44671723@N00"&&(t=!0)}),t})},canVr:function(){var t=this,n,r,i=!1;return t.appContext.flipper.isFlipped("enable-vr")?(n=t.get("photo"),n&&(r=n.getValue("aspectRatio"),r&&r>=1.99&&r<=2.01&&(i=!0)),i?e.Promise.all([t.appContext.callAPI("flickr.vr.isEquirectangular",{photo_id:n.id})]).then(function(t){return e.Promise.resolve(!!t[0].is_equirectangular)}):e.Promise.resolve(!1)):e.Promise.resolve(!1)},onParentViewEvent:function(e,t){var n;if(t&&t[0]){n=t[0];switch(n){case"vrIconClicked":this.openVr();break;case"vKeyPressed":this.toggleVr()}}},toggleVr:function(){this.immersed?this.closeVr():this.openVr()},openVr:function(t){if(this.immersed||t&&t.target.hasClass("close")){this.vr.controls&&this.vr.controls.autoRotate&&(this.vr.controls.autoRotate=!1);return}var n=this,r=this.get("photo"),i=r.getLargestSize(),s=this.templates("flickr-balls")({}),o=new Image,u,a;t&&t.halt(),a=e.Node.create("<div></div>"),a.addClass("vr-loading-layer"),a.addClass("fluid"),a.append(s),n.get("container").append(a),u=i.displayUrl.replace("staticflickr","static.flickr"),o.crossOrigin="anonymous",o.onload=function(){n.immersed=!0,n.vr=new window.Flickvr,n.vr.initialize(u,{container:n.get("container").getDOMNode(),useContainerDimensions:!n.isMobile,enableVrHeadset:n.appContext.flipper.isFlipped("enable-vr-headset"),autoRotate:!n.isMobile}).then(function(t){e.fire("photo:entering-vr"),t.style.position="absolute",n.vr.enterVR(),n.get("container").one(".vr-loading-layer").remove(),n.get("container").addClass("immersed"),n.escHandle=n.attachKeyEvent("down:27",e.betterThrottle(n.closeVr.bind(n),100))})},o.src=u},closeVr:function(e){var t=this.get("container");e&&e.preventDefault(),this.vr&&this.vr.destroy(),this.escHandle&&(this.detachRegisteredEvent(this.escHandle),delete this.escHandle),this.immersed=!1,t.removeClass("immersed")},beforeDestroy:function(){this.set("lastContainer",this.get("container")),this.immersed&&this.closeVr()},destructor:function(){var e=this.get("lastContainer");e&&(e.remove(!0),this.set("lastContainer",null))}})},"@VERSION@",{requires:["flickr-view","better-throttle","get","hermes-template-vr-overlay","hermes-template-flickr-balls"],optional:["photo-models","photo-tags-models","photo-groups-models"],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-lang-photo-page-scrappy_it-it",function(e,t){e.Intl.add("hermes/photo-page-scrappy","it-IT",{PAGE_TITLE:["${title}"," | Flickr"],BACK_TO:["Torna a ","${entryType}"],COULDNT_UPDATE_SETTINGS:["Non \u00e8 stato possibile aggiornare le impostazioni"],ADULT_CONTENT:["Contenuti per adulti"],MATURE_AUDIENCES:["Questo contenuto \u00e8 solo per un pubblico adulto."],USER_DISCRETION:["Consigliamo agli utenti di usare discrezione."],SHOW_ME_THIS_CONTENT_TYPE:["Visualizza il tipo di contenuto a partire da questo momento"],CHANGE_SAFE_SEARCH_IN_SETTINGS:['Puoi sempre modificare <a href="/account/prefs/safesearch/?from=privacy"  data-track="photoWellSafeSearchClick">le impostazioni di Ricerca sicura</a> nelle preferenze del tuo account.'],SIGNED_IN_FOR_CONTENT:["Per visualizzare il contenuto devi aver effettuato l'accesso."],VIDEO_COMING_SOON:["Supporto video presto disponibile"],FIND_OUT_MORE_AD:["Ulteriori informazioni in ","${brand}"],SHARE_THIS_PHOTO:["Condividi questa foto"],DOWNLOAD_THIS_VIDEO:["Scarica questo video"],DOWNLOAD_THIS_PHOTO:["Scarica questa foto"],VIEW_ALL_SIZES:["Visualizza tutte le dimensioni"],DOWNLOAD_PHOTO:["Scarica foto"],SOME_RIGHTS_RESERVED:["Alcuni diritti sono riservati"],DOWNLOAD:["Scarica"],ERROR_LOADING_CONTEXT:["Errore durante il caricamento del contesto"],ADD_TITLE:["Aggiungi titolo"],ADD_DESCRIPTION:["Aggiungi descrizione"],TITLE_DESCRIPTION_FAILURE:["Al momento non \u00e8 possibile modificare il titolo e la descrizione."],VIEW_PREVIOUS_COMMENT:["Visualizza commento precedente"],VIEW_MORE_PREVIOUS_COMMENTS:["Visualizza ","${count}"," commenti precedenti"],EMPTY_COMMENT_ERROR:["Una casella di commento vuota? Questo non \u00e8 consentito."],COMMENT_RATE_LIMIT_ERROR:["Riduci i commenti. Per proteggere la community di Flickr contro spam e comportamenti potenzialmente rischiosi abbiamo imposto alcuni limiti relativi alla pubblicazione dei commenti."],COMMENT_POST_ERROR:["Impossibile pubblicare il tuo commento."],MORE_COMMENTS_ERROR:["Impossibile ottenere pi\u00f9 commenti."],COMMENT_PERMALINK_ERROR:["Impossibile trovare il commento specificato sulla foto."],DELETE_COMMENT:["Elimina commento"],COMMENT_DELETE_CONFIRMATION:["Eliminare questo commento?"],COMMENT_DELETE_ERROR:["Impossibile eliminare il tuo commento."],COMMENT_LOADING_ERROR:["Errore durante il caricamento dei commenti"],COMMENT:["Commento"],SHOW_MORE_COMMENTS:["Altri ","${count}"],REPLY:["Rispondi"],PERMALINK:["Permalink"],SINGLE_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAlias}",'/">',"${displayName}","</a> l'ha aggiunta ai Preferiti"],DOUBLE_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAliasOne}",'/">',"${displayNameOne}",'</a> e <a class="faved-by-person-link" href="/photos/',"${pathAliasTwo}",'/">',"${displayNameTwo}","</a> l'hanno aggiunta ai Preferiti"],TRIPLE_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAliasOne}",'/">',"${displayNameOne}",'</a>, <a class="faved-by-person-link" href="/photos/',"${pathAliasTwo}",'/">',"${displayNameTwo}",'</a> e <a class="faved-by-person-link" href="/photos/',"${pathAliasThree}",'/">',"${displayNameThree}","</a> l'hanno aggiunta ai Preferiti"],MULTI_FAVER:['<a class="faved-by-person-link" href="/photos/',"${pathAliasOne}",'/">',"${displayNameOne}",'</a>, <a class="faved-by-person-link" href="/photos/',"${pathAliasTwo}",'/">',"${displayNameTwo}",'</a> e <a class="remaining-faved-by" href="#">',"${count}"," ulteriori persone</a> l'hanno aggiunta ai Preferiti"],RELATIONSHIP_FRIEND_ERROR:["Si \u00e8 verificato un problema durante l'impostazione della relazione con il tuo amico."],RELATIONSHIP_FAMILY_ERROR:["Si \u00e8 verificato un problema durante l'impostazione delle tue relazioni familiari."],HIDE_EXIF:["Nascondi EXIF"],SHOW_EXIF:["Mostra EXIF"],EDIT_LOCATION:["Modifica localit\u00e0"],EDIT_LOCATION_ORGANIZR:["Stiamo lavorando sodo a un nuovo progetto che ci consentir\u00e0 di offrirti un modo ancora migliore di goderti le foto. Per adesso, puoi modificare la posizione in Organizr."],SAVE_LOCATION:["Salva posizione"],APERTURE:["Apertura"],FOCAL_LENGTH:["Lunghezza focale"],EXPOSURE_TIME:["Tempo di esposizione"],FLASH_AUTO_FIRED:["Flash (automatico, attivato)"],FLASH_AUTO_NO_FIRE:["Flash (automatico, non attivato)"],FLASH_ON_FIRED:["Flash (accesso, attivato)"],FLASH_ON_NO_FIRE:["Flash (acceso, non attivato)"],FLASH_OFF:["Flash (spento, non attivato)"],FLASH_SIMPLE_ON:["Attivato"],FLASH_SIMPLE_OFF:["Disattivato"],POWERED_BY:["SVILUPPATO DA"],FOURSQUARE:["FOURSQUARE"],ADD_PHOTO_TO_MAP:["Aggiungi questa foto alla tua mappa"],SINGULAR_FAVE:["Preferita"],PLURAL_FAVE:["preferiti"],SINGULAR_VIEW:["visualizzazione"],PLURAL_VIEW:["visualizzaz."],SINGULAR_COMMENT:["commento"],PLURAL_COMMENT:["commenti"],LICENSE_ERROR:["Si \u00e8 verificato un problema durante la modifica della licenza della foto"],ALL_RIGHTS_RESERVED:["Tutti i diritti riservati"],NO_RESTRICTIONS:["Nessuna limitazione di copyright nota"],PUBLIC_DOMAIN:["Di dominio pubblico"],USA_GOV_WORK:["Opera del Governo degli Stati Uniti"],SAFETY_CHANGE_ERROR:["Si \u00e8 verificato un errore durante la modifica del livello di sicurezza della tua foto"],PRIVACY_CHANGE_ERROR:["Si \u00e8 verificato un problema durante la modifica della privacy della tua foto"],COMMENT_PERM_CHANGE_ERROR:["Si \u00e8 verificato un errore durante la modifica dell'autorizzazione per i commenti della tua foto"],FLAG_PHOTO:["Contrassegna foto"],MARK_FOR_REVIEW:["Contrassegna per la revisione"],ADDITIONAL_INFO:["Ulteriori informazioni"],VIEWING_THIS_PHOTO:["Visualizzazione foto"],PRIVACY_UPDATE_ERROR:["Si \u00e8 verificato un errore durante l'aggiornamento della privacy. Riprova."],META_PERMS_UPDATE_ERROR:["Si \u00e8 verificato un errore durante l'aggiornamento dell'autorizzazione per l'aggiunta di metatag. Riprova."],ADD_META_TO_THIS_PHOTO:["Aggiungi tag e persone a questa foto"],COMMENT_PERMS_UPDATE_ERROR:["Si \u00e8 verificato un errore durante l'aggiornamento dell'autorizzazione per i commenti. Riprova."
],COMMENTING_ON_THIS_PHOTO:["Chi pu\u00f2 lasciare commenti su questa foto"],SAFETY_UPDATE_ERROR:["Si \u00e8 verificato un errore durante l'aggiornamento del livello di sicurezza. Riprova."],SAFETY_LEVEL_OF_PHOTO:["Livello di sicurezza di questa foto"],FLAG_ERROR:["Si \u00e8 verificato un errore durante il tentativo di contrassegnare questa foto. Riprova."],PROVIDE_FEEDBACK:["Invia un commento sulla nuova pagina delle foto."],ERROR_DELETING_AUTOTAG:["Errore nell'eliminazione del tagautomatico"],AUTOTAGS:["Tagautomatici"],CONTACT_LIST_ERROR:[" Si \u00e8 verificato un errore durante il tentativo di recuperare l'elenco dei contatti. Riprova."],FAILED_TO_REMOVE_PERSON:["Tentativo di rimozione di tale persona dalla foto non riuscito."],PERSON_CANNOT_BE_TAGGED:["Questa persona non pu\u00f2 essere taggata."],PEOPLE_IN_PHOTO:["Persone nella foto"],ADD_PEOPLE:["Aggiungi persone"],ADD_PERSON:["Aggiungi una persona"],ERROR_REMOVING_FROM_GROUP:["Si \u00e8 verificato un problema durante la rimozione della foto dal gruppo"],ERROR_ACCEPTING_INVITATION:["Si \u00e8 verificato un problema durante l'accettazione dell'invito del gruppo"],SEARCH_GROUPS:["Cerca gruppi"],PHOTO_NOT_IN_GROUPS:["Questa foto non \u00e8 attualmente presente in nessun gruppo"],ADD_TO_GROUP:["Aggiungi al gruppo"],INVITE_TO_GROUP:["Invita nel gruppo"],ONE_GROUP_INVITATION:["Hai ricevuto 1 invito del gruppo"],N_GROUP_INVITATIONS:["Hai ricevuto ","${count}"," inviti del gruppo"],VIEW_MORE_GROUPS:["Visualizza altri gruppi"],ERROR_REMOVING_FROM_ALBUM:["Si \u00e8 verificato un problema durante la rimozione della foto dall'album"],WARNING_REMOVE_LAST_PHOTO_FROM_ALBUM:["Stai per rimuovere l'ultima foto da un album; ci\u00f2 comporter\u00e0 anche l'eliminazione dell'album."],REMOVE_PHOTO_AND_ALBUM:["Rimuovi la foto ed elimina l'album"],ADD_PHOTO_TO_ALBUM:["Aggiungi questa foto a un album"],SEARCH_ALBUMS:["Cerca tra gli album"],ADD_TO_ALBUM:["Aggiungi all'album"],PHOTO_NOT_IN_ALBUMS:["Questa foto non \u00e8 attualmente presente in nessun album"],VIEW_MORE_ALBUMS:["Visualizza altri album"],PHOTO_IN_ONE_ALBUM:["Questa foto \u00e8 presente in 1 album"],PHOTO_IN_N_ALBUMS:["Questa foto \u00e8 presente in ","${count}"," album"],INVITE_PENDING:["Invito in sospeso"],CANCEL_INVITE:["Annulla invito"],ACCEPT_INVITE:["Accetta invito"],ONE_ITEM:["1 elemento"],N_ITEMS:["${count}"," elementi"],ERROR_REMOVING_FROM_GALLERY:["Si \u00e8 verificato un problema durante la rimozione della foto dalla galleria"],SEARCH_GALLERIES:["Cerca tra le gallerie"],ADD_TO_GALLERY:["Aggiungi alla galleria"],PHOTO_NOT_IN_GALLERIES:["Questa foto non \u00e8 attualmente presente in nessuna galleria"],VIEW_MORE_GALLERIES:["Visualizza altre gallerie"],PHOTO_IN_ONE_GALLERY:["Questa foto \u00e8 presente in 1 galleria"],PHOTO_IN_N_GALLERIES:["Questa foto \u00e8 presente in ","${count}"," gallerie"],DELETE_PHOTO:["Elimina foto"],PERMANTENTLY_DELETE:["Vuoi eliminare definitivamente questa foto?"],EDIT_PHOTO:["Modifica foto"],NO_VIDEOS_IN_AVIARY:["Impossibile modificare video con Aviary"],ENHANCE_WITH_AVIARY:["Ritocca con Aviary"],NO_VIDEO_ROTATION:["I video non posso essere ruotati"],ROTATE:["Ruota"],NO_VIDEO_REPLACE:["I video non posso essere sostituiti"],REPLACE:["Sostituisci"],PHOTO_NAVIGATION:["Naviga tra le foto"],THUMBNAIL_NAVIGATION:["Naviga tra le anteprime"],ZOOM:["Zoom"],VIEW_IN_LIGHTBOX:["Visualizza nel riquadro"],BACK_TO_CONTEXT:["Torna al contesto"],ADD_TAG:["Aggiungi tag"],GO_TO_ORGANIZER:["Vai a Organizr"],ALBUM:["album"],ALBUMS:["gli album"],ERROR_LOADING_ALBUMS:["Si \u00e8 verificato un problema durante il caricamento dei tuoi album"],ERROR_ADDING_PHOTO_TO_ALBUM:["Si \u00e8 verificato un problema durante l'aggiunta della foto dall'album"],ERROR_REMOVING_PHOTO_FROM_ALBUM:["Si \u00e8 verificato un problema durante la rimozione della foto dall'album"],ERROR_LOADING_GROUPS:["Si \u00e8 verificato un problema durante il caricamento dei gruppi ai quali puoi aggiungere le foto"],ERROR_ADDING_TO_GROUP:["Si \u00e8 verificato un problema durante l'aggiunta della foto al gruppo"],ERROR_ADDING_TO_GROUP_NOT_OWNER:["Spiacenti, non \u00e8 stato possibile aggiungere la foto al gruppo perch\u00e9 non sei il proprietario della foto."],ERROR_ADDING_TO_GROUP_NOT_MEMBER:["Spiacenti, non \u00e8 stato possibile aggiungere la foto al gruppo. Non sei iscritto a questo gruppo."],ERROR_ADDING_TO_GROUP_ALREADY_IN_POOL:["La foto \u00e8 gi\u00e0 nel pool del gruppo."],ERROR_ADDING_TO_GROUP_MAX_POOLS:["Spiacenti, non \u00e8 stato possibile aggiungere al foto al gruppo perch\u00e9 si trova gi\u00e0 nel numero massimo di pool del gruppo."],ERROR_ADDING_TO_GROUP_MAX_PHOTOS_FROM_USER:["Spiacenti, non \u00e8 stato possibile aggiungere la foto al gruppo. Hai gi\u00e0 aggiunto il numero massimo di foto al pool."],ERROR_ADDING_TO_GROUP_ADDED_TO_QUEUE:["La tua foto \u00e8 gi\u00e0 stata aggiunta alla coda in sospeso per il gruppo."],ERROR_ADDING_TO_GROUP_ALREADY_IN_QUEUE:["La tua foto \u00e8 gi\u00e0 nella coda in sospeso per il gruppo."],ERROR_ADDING_TO_GROUP_INVALID_CONTENT:["Spiacenti, non \u00e8 stato possibile aggiungere la foto al gruppo. Per ulteriori informazioni, clicca sui requisiti del gruppo relativi a tipo di media, tipo di contenuto, livello di sicurezza e posizione geografica."],ERROR_ADDING_TO_GROUP_MAX_IN_POOL:["Spiacenti, non \u00e8 stato possibile aggiungere la foto al gruppo. Il gruppo ha raggiunto il numero massimo di foto consentite in un pool."],ERROR_INVITING_TO_GROUP:["Si \u00e8 verificato un problema durante l'invito relativo alla foto al gruppo"],ERROR_CANCELING_GROUP_INVITIATON:["Si \u00e8 verificato un problema durante l'eliminazione della richiesta della foto al gruppo"],NO_MATCHES:["Nessuna corrispondenza"],CREATE_NEW:["Crea nuovo"],ERROR_LOADING_GROUP_INVITATIONS:["Si \u00e8 verificato un problema durante il caricamento degli inviti al gruppo relativi alla foto"],NO_GROUP_INVITATIONS:["Nessun invito al gruppo in sospeso"],PENDING_INVITATIONS_FOR_PHOTO:["Inviti in sospeso relativi alla foto"
],LOADING_INVITATIONS:["Caricamento degli inviti in corso"],ERROR_LOADING_GALLERIES:["Si \u00e8 verificato un problema durante il caricamento delle tue gallerie"],ERROR_ADDING_TO_GALLERY:["Si \u00e8 verificato un problema durante l'aggiunta della foto alla galleria"],ERROR_PHOTO_NOT_ALLOWED_IN_GALLERY:["Il proprietario di questa foto non ti consente di aggiungere la foto alla tua galleria"],ERROR_CREATING_GALLERY:["Si \u00e8 verificato un problema durante la creazione della tua nuova galleria"],DATE_TAKEN_FORMAT:["La data di scatto deve essere nel formato MM/GG/AAAA hh:mm:ss."],DATE_POSTED_FUTURE:["La data di pubblicazione non pu\u00f2 essere nel futuro."],DATE_UPLOADED_FUTURE:["La data del caricamento non pu\u00f2 essere nel futuro."],DATE_POSTED_FLICKR_JOIN:["La data di pubblicazione deve essere successiva alla tua registrazione a Flickr."],DATE_UPLOADED_FLICKR_JOIN:["La data del caricamento deve essere successiva alla tua registrazione a Flickr."],ERROR_SAVING_DATE:["Errore durante il salvataggio delle date"],DATE_INVALID:["Una o pi\u00f9 date non sono valide"],EDIT_DATES:["Modifica date"],DATE_TAKEN_ON:["Data dello scatto"],DATE_POSTED_ON:["Data pubblicazione"],DATE_UPLOADED_ON:["Caricata il "],TAKEN_CIRCA:["Scattata intorno al ","${intlDate}"],TAKEN_SOMETIME_IN:["Scattata nel ","${intlDate}"],TAKEN_IN:["Scattata in ","${intlDate}"],TAKEN_ON:["Scattata il ",{type:"date",valueName:"intlDate",format:"long"}],UPLOADED_ON:["Caricata il ","${intlDate}"],SOMETHING_WENT_WRONG:["Qualcosa non ha funzionato."],REFRESH_BROWSER:["Aggiorna il tuo browser e riprova."],TWITTER_NOT_FOUND:["Account Twitter non trovato nella pubblicazione"],TUMBLR_NOT_FOUND:["Account Tumblr non trovato nella pubblicazione"],LINK:["Collegamento"],LINK_TO_VIDEO:["Collega a questo video:"],LINK_TO_PHOTO:["Collega a questa foto:"],NO_LINKS_FOR_RESTRICTED_VIDEO:["I collegamenti non sono disponibili per i video con restrizioni"],PRIVATE_VIDEO_SHARE:["Questo \u00e8 un video privato; vuoi condividerlo comunque?"],NO_LINKS_FOR_RESTRICTED_PHOTO:["I collegamenti non sono disponibili per le foto con restrizioni"],PRIVATE_PHOTO_SHARE:["Questa \u00e8 una foto privata; vuoi condividerla comunque?"],SHARING_RESTRICTED_VIDEO:["La condivisione \u00e8 limitata per questo video"],SHARING_RESTRICTED_PHOTO:["La condivisione \u00e8 limitata per questa foto"],EMBED:["Incorpora"],PUBLIC_TO_SHARE:["Condividi questa foto pubblicamente per visualizzare il codice di incorporamento"],SIZE:["Dimensioni:"],TITLE_AND_OWNER_AT_START:["Visualizza il titolo e il proprietario all'avvio"],SHARE_NOW:["Condividi ora!"],SHARE_PHOTO:["Condividi foto"],SHARE_ON_TWITTER:["Condividi su Twitter"],AUTHORIZE_FOR_TWITTER:["autorizza Flickr a pubblicare su Twitter"],SHARE_ON_TUMBLR:["Condividi su Tumblr"],PUBLISH_NOW:["Pubblica adesso"],ADD_TO_QUEUE:["Aggiungi alla coda"],SAVE_AS_DRAFT:["Salva come bozza"],AUTHORIZE_FOR_TUMBLR:["autorizza Flickr a pubblicare su Tumblr"],SHARE_VIA_MAIL:["Condividi via email"],SCREEN_NAME_OR_EMAIL:["Nome visualizzato o email"],SQUARE:["Quadrata"],SMALL:["Piccola"],MEDIUM:["Medie"],LARGE:["Grandi"],ORIGINAL:["Originale"],DUPLICATE_TAG:["Tag duplicato"],INVALID_TAG:["Tag non valido"],MAXIMUM_TAG_LIMIT:["Raggiunto il limite di lunghezza del tag (76)"],MAX_TAG_LIMIT:["Raggiunto numero massimo di tag (75)"],ERROR_ADDING_TAG:["Errore durante l'aggiunta del tag"],ERROR_DELETING_TAG:["Errore durante l'eliminazione del tag"],TAGS:["Tag"],ADD_TAGS:["Aggiungi tag"],ADD_A_TAG:["Aggiungi un tag"],PHOTO_IN_ONE_GROUP:["Questa foto \u00e8 presente in 1 gruppo"],PHOTO_IN_MANY_GROUPS:["Questa foto \u00e8 presente in ",{type:"number",valueName:"count"}," gruppi"],PHOTO_IN_NO_GROUPS:["Questa foto non \u00e8 presente in alcun gruppo"],ADD_A_COMMENT:["Aggiungi un commento"],COMMENT_TUTORIAL:["premi INVIO per pubblicare e MAIUSC+INVIO per andare a capo"],SIGNED_IN_TO_POST_A_COMMENT:["Devi aver effettuato l'accesso per poter pubblicare un commento"],SHARE:["Condividi"],CODE:["Codice"],INCLUDE_A_MESSAGE:["Includi un messaggio"],FOR_MORE_INFORMATION_SAFESEARCH:['Per ulteriori informazioni, leggi le <a href="//www.flickr.com/help/photos/?search=flag#145">risposte alle FAQ</a>.'],FLAG_CONFIRMATION_SAFE_WITHIN:['Questa foto \u00e8 contrassegnata come <a href="//www.flickr.com/help/filters/#258">sicura</a> e rientra nelle tue <a href="//www.flickr.com/account/prefs/safesearch/">impostazioni SafeSearch</a>.'],FLAG_CONFIRMATION_SAFE_OUTSIDE:['Questa foto \u00e8 contrassegnata come <a href="//www.flickr.com/help/filters/#258">sicura</a> e non rientra nelle tue <a href="//www.flickr.com/account/prefs/safesearch/">impostazioni SafeSearch</a>.'],FLAG_CONFIRMATION_MODERATE_WITHIN:['Questa foto \u00e8 contrassegnata come <a href="//www.flickr.com/help/filters/#258">moderata</a> e rientra nelle tue <a href="//www.flickr.com/account/prefs/safesearch/">impostazioni SafeSearch</a>.'],FLAG_CONFIRMATION_MODERATE_OUTSIDE:['Questa foto \u00e8 contrassegnata come <a href="//www.flickr.com/help/filters/#258">moderata</a> e non rientra nelle tue <a href="//www.flickr.com/account/prefs/safesearch/">impostazioni SafeSearch</a>.'],FLAG_CONFIRMATION_RESTRICTED_WITHIN:['Questa foto \u00e8 contrassegnata come <a href="//www.flickr.com/help/filters/#258">riservata</a> e rientra nelle tue <a href="//www.flickr.com/account/prefs/safesearch/">impostazioni SafeSearch</a>.'],FLAG_CONFIRMATION_RESTRICTED_OUTSIDE:['Questa foto \u00e8 contrassegnata come <a href="//www.flickr.com/help/filters/#258">riservata</a> e non rientra nelle tue <a href="//www.flickr.com/account/prefs/safesearch/">impostazioni SafeSearch</a>.'],PRIVATE_PHOTO:["Foto privata"],PHOTO_UNFIT_FOR_YOUR_EYES:["La foto non \u00e8 adatta ai tuoi occhi. Eccoti un gattino: (^._.^)\uff89"],NO_PHOTO_WITH_THAT_ID:["Nessuna foto trovata con l'ID ","${photoId}"],NO_MEMBERS_FOUND:["Nessun membro trovato"],TAKEN_ON_INTL:["Scattata il ",{type:"date",valueName:"intlDate",format:"long"}],UPLOADED_ON_INTL:["Caricata il ",{type:"date",valueName:"intlDate"
,format:"long"}],TAKEN_IN_MONTH:["Scattata in ",{type:"date",valueName:"intlDate",format:"monthYear"}],VIEW_IN_LIGHTBOX_SHORTCUT:["Visualizza con Lightbox"],ZOOM_MAX_MESSAGE:["Ehi, aspetta un attimo! Questa foto ha gi\u00e0 raggiunto le dimensioni massime."],CLICK_TO_FAVE_PHOTO:["Fai clic qui per aggiungere la foto ai preferiti"],CLICK_TO_FAVE_VIDEO:["Fai clic qui per aggiungere il video ai preferiti"],BACK_TO_ACTIVITY_FEED:["Torna al feed attivit\u00e0"],BACK_TO_PHOTOSTREAM:["Torna al fotostream"],BACK_TO_SHARED_PHOTOS:["Torna alle foto condivise"],BACK_TO_ALBUM:["Torna all'album"],BACK_TO_CONTACTS_LIST:["Torna all'elenco dei contatti"],BACK_TO_FAVORITES:["Torna ai preferiti"],BACK_TO_GALLERY:["Torna alla galleria"],BACK_TO_PROFILE:["Torna al profilo"],BACK_TO_EXPLORE:["Torna all'esplorazione"],BACK_TO_COMMONS:["Torna a Commons"],BACK_TO_GROUP:["Torna al gruppo"],BACK_TO_GROUPS:["Torna ai gruppi"],BACK_TO_MAP:["Torna alla mappa"],BACK_TO_SEARCH:["Torna alla ricerca"],BACK_TO_TAG:["Torna a taggare"],ERROR_ADDING_PHOTOS_TO_ALBUM:["Si \u00e8 verificato un problema durante l'aggiunta delle foto all'album"],ERROR_REMOVING_PHOTOS_FROM_ALBUM:["Si \u00e8 verificato un problema durante la rimozione delle foto dall'album"],ERROR_CREATING_ALBUM:["Si \u00e8 verificato un problema durante la creazione del tuo nuovo album"],STRICTER_PRIVACY_CHANGE_DIALOG_TITLE:["Scelta di un livello di privacy superiore"],STRICTER_PRIVACY_CHANGE_DIALOG_MESSAGE:["La scelta di un livello di privacy superiore per una foto comporter\u00e0 la rimozione di tutti i preferiti accumulati. Inoltre, l'URL della foto verr\u00e0 modificato."],TAGS_HELPER_TEXT:["I tag sono delle parole chiave che permettono di trovare le foto pi\u00f9 facilmente. Aggiungi tutti i tag che desideri e i simpatici robot di Flickr ti aiuteranno aggiungendone altri per te."],TAGS_HELP_TEXT:["I tag sono parole chiave che semplificano la ricerca delle foto in Flickr. Quelli aggiunti da te sono in grigio scuro. I simpatici robot di Flickr ti aiuteranno aggiungendone automaticamente alcuni per te, li riconoscerai dal contorno grigio."],PRIVATE_TAGS_OWNER_HELPER_TEXT:["Questo \u00e8 un tag privato. Pu\u00f2 essere visualizzato soltanto da te e dai tuoi amici e familiari autorizzati a vedere questa foto."],PRIVATE_TAGS_FRIENDS_FAMILY_HELPER_TEXT:["Questo \u00e8 tag privato. Puoi visualizzarlo perch\u00e9 sei un amico o un familiare del proprietario della foto."],CREATE_WALLART_WITH_PHOTO:["Crea stampe con questa foto"],ERROR_ROTATING_PHOTO:["Si \u00e8 verificato un problema durante la rotazione della foto. Chiudi l'elemento e riprova."],ROTATE_PHOTO:["Ruota foto"],ERROR_REPLACING_PHOTO:["Si \u00e8 verificato un problema durante la sostituzione della foto. Chiudi l'elemento e riprova."],REPLACE_PHOTO:["Sostituisci foto"],PERMANENTLY_REPLACE:['Sostituisci in modo permanente questa foto ("',"${photoTitle}",'" di ',"${username}",") con <em>","${fileName}","</em>?"],REPLACE_WARNING:["L'operazione di sostituzione di una foto non \u00e8 reversibile. Scegli il file con cui vuoi sostituire la foto."],REPLACE_UPLOADING:["Caricamento di <em>","${fileName}","</em> in corso..."],ERROR_DELETING_PHOTO:["Si \u00e8 verificato un errore durante l'eliminazione della foto. Chiudi e riprova."],SHOW_MORE_STATS:["Mostra altre statistiche"],SIGNUP_AND_DOWNLOAD_TITLE:["Ho trovato una foto da scaricare!"],SIGNUP_AND_DOWNLOAD_VIDEO_TITLE:["Hai trovato un video da scaricare!"],SIGNUP_AND_DOWNLOAD_MESSAGE:["Iscriviti a Flickr per accedere a miliardi di foto."],SIGNUP_AND_COMMENT_TITLE:["Commenta questa foto!"],SIGNUP_AND_COMMENT_MESSAGE:["Iscriviti a Flickr per aggiungere un commento a questa foto."],IMMERSIFY:["Immersify"],SIGNUP_FOOTER_MESSAGE:["Iscriviti a Flickr per esplorare foto stupende da tutto il mondo"],TIMEOUT_FAILURE:["Al momento stiamo riscontrando problemi per mostrare questa foto. Riprova."],BUY:["Acquista"],ADD_A_NOTE:["Aggiungi una nota"],CONFIRM_NOTE_DELETION:["Vuoi davvero eliminare in modo definitivo questa nota?"],VIEWING_PRIVACY:["Impostazioni privacy visualizzazione"],ALLOW_COMMENTING:["Consenti l\u2019inserimento di commenti"],ALLOW_TAGS_NOTES_PEOPLE:["Consenti i tag, le note e i tag delle persone"],SAFETY_LEVEL:["Livello di sicurezza"],SET_SAFETY_LEVEL:["Imposta il livello di sicurezza"],KEYBOARD_SHORTCUTS:["Tasti di scelta rapida"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-template-zoom",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){return""},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/zoom",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-zoom-modal",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s;return'<img src="'+e.escapeExpression((s=(s=n.smallSrc||(t!=null?t.smallSrc:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"smallSrc",hash:{},data:i}):s))+'" class="zoom-small">'},3:function(e,t,n,r,i){var s;return'<img src="'+e.escapeExpression((s=(s=n.largeSrc||(t!=null?t.largeSrc:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"largeSrc",hash:{},data:i}):s))+'" class="zoom-large">'},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{};return'<div class="zoom-modal hidden">\n	<div class="zoom-photo-container">\n		'+((s=n["if"].call(o,t!=null?t.smallSrc:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n		"+((s=n["if"].call(o,t!=null?t.largeSrc:t,{name:"if",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n		<span class="facade-of-protection-zoom"></span>\n	</div>\n</div>\n'},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/zoom-modal",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("animation-manager",function(e){e.AnimationManager=function(){function i(){return n=!1,r=[],!YUI.Env.isServer&&!e.config.win.requestAnimationFrame&&s(),{subscribe:u}}function s(){var t=["webkit","moz"],n,r,i=0;for(r=0;r<t.length&&!e.config.win.requestAnimationFrame;++r)n=t[r],e.config.win.requestAnimationFrame=e.config.win[n+"RequestAnimationFrame"],e.config.win.cancelAnimationFrame=e.config.win[n+"CancelAnimationFrame"]||e.config.win[n+"CancelRequestAnimationFrame"];if(!e.config.win.requestAnimationFrame||!e.config.win.cancelAnimationFrame)e.config.win.requestAnimationFrame=function(e){var t=Date.now(),n=Math.max(i+16,t);return setTimeout(function(){e(i=n)},n-t)},e.config.win.cancelAnimationFrame=clearTimeout}function o(){if(!n)return;r.forEach(function(e,t){e()}),e.config.win.requestAnimationFrame(o)}function u(t){return r.push(t),n||(n=!0,e.config.win.requestAnimationFrame(o)),{detach:function(){r.splice(r.indexOf(t),1),r.length||(n=!1)}}}var t,n,r;return t||(t=i()),t}()},"@VERSION@",{requires:[]});
YUI.add("zoom-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,forceGpu:null,initializer:function(t){return this.photoId=t.photoId,this.disableIfSmall=!!t.disableIfSmall,YUI.Env.isServer||(e.config.win.location.search.indexOf("gpu=on")>-1?this.forceGpu=!0:e.config.win.location.search.indexOf("gpu=off")>-1&&(this.forceGpu=!1)),this},loadState:function(){var e=this;return this.appContext.getModel("photo-models",e.photoId).then(function(t){e.set("photo",t)})},buildContainer:function(){return this.setContainerWithTemplate("zoom"),this},activate:function(){var t=this,n=t.getZoomKeyScope();return this.get("photo").getValue("needsInterstitial")||(this.parentViewContainer=this.get("container").ancestor(".view"),t.registerEventHandler(t.get("container").on("click",function(n){n.preventDefault(),t.cursorCoords=[n.pageX-e.config.win.pageXOffset,n.pageY-e.config.win.pageYOffset],e.rapidTracker.beacon(t.name,"zoomInClick"),t.zoomIn(t.cursorCoords)})),t.registerEventHandler(e.on("photo:zoom",function(n){n.x&&n.y?(t.cursorCoords=[n.x-e.config.win.pageXOffset,n.y-e.config.win.pageYOffset],t.zoomIn(t.cursorCoords)):t.zoomIn(),e.rapidTracker.beacon(t.name,"zoomInRemoteFire")})),t.attachKeyEvent("down:90",e.betterThrottle(function(n){n.preventDefault(),e.rapidTracker.beacon(t.name,"zoomInKeyPress"),t.zoomIn()},100)),t.attachKeyEvent("down:90,27",e.betterThrottle(function(n){n.preventDefault(),e.rapidTracker.beacon(t.name,"zoomOutKeyPress"),t.zoomOut()},100),n),t.attachKeyEvent("down:37,38,39,40",e.betterThrottle(function(n){var r=[t.currentZoomRegion.left,t.currentZoomRegion.top],i=200;n.preventDefault();switch(n.button){case 37:r[0]+=i;break;case 38:r[1]+=i;break;case 39:r[0]-=i;break;case 40:r[1]-=i}e.rapidTracker.beacon(t.name,"zoomPanKeyPress"),t.panZoomNode(r)},16),n),t.registerEventHandler(t.appContext.flapp.before("activeViewChange",function(n){e.fire("flickr:removeKeyEventScope",t.getZoomKeyScope()),t.detachRegisteredEvents(),t.detachEventHandlers(),t.cleanUp()}))),this},getZoomEdgeMargin:function(){return 100},panZoomNodeToCurrentCoords:function(){if(!this.zoomedIn)return;var e=this.cursorCoords,t=this.getZoomPanCoordsForCursor(e);if(!t)return;this.panZoomNode(t)},panZoomNode:function(e){if(this.currentZoomRegion.left===e[0]&&this.currentZoomRegion.top===e[1])return;e=this.constrainPanCoords(e),this.currentZoomRegion.left=e[0],this.currentZoomRegion.top=e[1],this.pendingCoords=e},constrainPanCoords:function(e){var t,n,r,i,s=this.getZoomEdgeMargin(),o=[this.appContext.viewportData.getWidth(),this.appContext.viewportData.getHeight()],u=[this.zoomImageFullWidth,this.zoomImageFullHeight],a=[u[0]+2*s,u[1]+2*s];return t=0,n=o[0]-u[0]-2*s,r=0,i=o[1]-u[1]-2*s,e[0]>t?e[0]=t:e[0]<n&&(e[0]=n),e[1]>r?e[1]=r:e[1]<i&&(e[1]=i),u[0]<o[0]&&(e[0]=.5*(o[0]-a[0])),u[1]<o[1]&&(e[1]=.5*(o[1]-a[1])),e},getZoomPanCoordsForCursor:function(e){if(!e)return;var t=this.getZoomEdgeMargin(),n=[this.appContext.viewportData.getWidth(),this.appContext.viewportData.getHeight()],r=[this.zoomImageFullWidth,this.zoomImageFullHeight],i=[r[0]+2*t,r[1]+2*t],s=[e[0]/n[0],e[1]/n[1]],o=[s[0]*(n[0]-i[0]),s[1]*(n[1]-i[1])];return o},getZoomSmallRegion:function(){var t=this.get("container");return{left:t.getX()-e.config.win.pageXOffset-this.getZoomEdgeMargin(),top:t.getY()-e.config.win.pageYOffset-this.getZoomEdgeMargin(),width:parseInt(t.getStyle("width"),10),height:parseInt(t.getStyle("height"),10)}},resizeZoomNode:function(t,n){var r=this,i,s,o=e.config.win.performance&&e.config.win.performance.now;return n?new e.Promise(function(n,u){function a(e){var u=o?e-i:Date.now()-i,a=u/r.getZoomTransitionTime(),f;return a>=1?(f=t,r.isAnimatingZoom=!1,setTimeout(function(){n()},r.getZoomTransitionTime())):f={left:s.left+(t.left-s.left)*a,top:s.top+(t.top-s.top)*a,width:s.width+(t.width-s.width)*a,height:s.height+(t.height-s.height)*a},f}function f(n){var i=a(n);if(r.zoomingIn||r.zoomingOut)r.resizeZoomNode(i,!1),i!==t&&e.config.win.requestAnimationFrame(f)}r.isAnimatingZoom=!0,i=o?e.config.win.performance.now():Date.now(),s=r.currentZoomRegion,e.config.win.requestAnimationFrame(f)}):(this.currentZoomRegion=t,this.zoomPhotoContainerNode&&this.zoomPhotoContainerNode.setStyle("transform","translate("+t.left+"px, "+t.top+"px) scale("+t.width/this.zoomImageFullWidth+")"),e.Promise.resolve())},getZoomTransitionTime:function(){return 200},zoomOut:function(){var t=this,n=this.zoomNode;e.fire("flickr:removeKeyEventScope",this.getZoomKeyScope()),this.detachEventHandlers(),this.resizeZoomNode(this.getZoomSmallRegion(),!0),n.addClass("hiding"),this.zoomedIn=!1,this.zoomingIn=!1,this.zoomingOut=!0,setTimeout(function(){t.zoomingOut&&n&&n._node&&(t.parentViewContainer.removeClass("zoomed"),n.removeClass("hiding"),n.addClass("hidden"),setTimeout(function(){t.zoomingOut&&(t.cleanUp(),this.zoomingOut=!1)},200))},this.getZoomTransitionTime()+0),delete this.pendingCoords,delete this.currentCoords},detachEventHandlers:function(){this.zoomNode&&(this.zoomNode.detachAll("mousemove"),this.mouseWheelHandler&&this.mouseWheelHandler.detach(),this.touchHandlers&&(this.touchHandlers.forEach(function(e){e.detach()}),delete this.touchHandlers))},cleanUp:function(){this.zoomNode&&(this.zoomNode.remove(!0),this.zoomedIn=!1,this.zoomingIn=!1,this.zoomingOut=!1,delete this.zoomNode,delete this.zoomPhotoContainerNode,delete this.pendingCoords,delete this.currentCoords,this.zoomAnimationHandle.detach())},isImageReadyToDisplay:function(e){var t;return e?(t=new Image,t.src=e,t.complete||t.naturalWidth):!1},getZoomKeyScope:function(){return this.name+this._yuid},zoomMouseMoveHandler:function(t){this.cursorCoords=[t.pageX-e.config.win.pageXOffset,t.pageY-e.config.win.pageYOffset],this.isAnimatingZoom||this.panZoomNodeToCurrentCoords()},zoomScrollWheelHandler:function(e){e.preventDefault();var t=e.wheelDeltaX,n=e.wheelDeltaY;t===undefined&&(t=-e.deltaX||0),n===undefined&&(n=-e.deltaY||0),this.panZoomNode([this.currentZoomRegion.left+t,this
.currentZoomRegion.top+n])},getSizes:function(){var e=this.parentViewContainer.one(".low-res-photo"),t=this.parentViewContainer.one(".main-photo");return{small:e?e.getAttribute("src"):"",medium:t?t.getAttribute("src"):"",large:this.getLargestSize()}},getLargestSize:function(){var e=this.appContext.flipper.isFlipped("enable-zoom-proxy"),t=this.appContext.flipper.config["zoom-proxy-prefix"],n;return e&&t?(n=this.get("photo").getLargestSize({excludeSizes:[]}),n.key==="o"&&(console.log("proxyPrefix",t,"largestSize.displayUrl",n.displayUrl),n.displayUrl=n.url=t+"http:"+n.displayUrl,console.log("proxying original",n.url))):n=this.get("photo").getLargestSize(),n},zoomIn:function(t){var n=this,r,i,s=this.getSizes(),o=this.isImageReadyToDisplay(s.medium),u=this.isImageReadyToDisplay(s.large.url),a=this.getZoomPixelRatio(),f=this.getZoomSmallRegion(),l,c,h,p=this.maxMsgNode;if(this.disableIfSmall&&f.width>=s.large.width){p||(p=this.maxMsgNode=e.Node.create('<div class="zoom-max-message">'+n.intlMessage({intlName:"photo-page-scrappy.ZOOM_MAX_MESSAGE"})+"</div>")),this.get("container").contains(p)||(p.addClass("hidden"),this.get("container").append(p)),setTimeout(function(){p&&p.inDoc()&&(p.removeClass("hidden"),this.maxMsgNodeHidingTimer&&(clearTimeout(this.maxMsgNodeHidingTimer),delete this.maxMsgNodeHidingTimer),this.maxMsgNodeHidingTimer=setTimeout(function(){p&&p.inDoc()&&p.addClass("hidden")},3e3))},0);return}e.fire("flickr:setKeyEventScope",this.getZoomKeyScope()),this.zoomingIn=!0,this.zoomAnimationHandle=e.AnimationManager.subscribe(function(){var r=n.getDeteriorationRateForEasing(),i,s,o={x:0,y:0},u={x:0,y:0},a={x:0,y:0};if(n.pendingCoords){o.x=parseInt(n.pendingCoords[0],10),o.y=parseInt(n.pendingCoords[1],10),n.currentCoords?(u.x=n.currentCoords[0],u.y=n.currentCoords[1]):(i=n.getZoomPanCoordsForCursor(t),s=n.constrainPanCoords(i),u.x=parseInt(s[0],10),u.y=parseInt(s[1],10)),o.x<u.x?a.x=u.x-Math.abs(o.x-u.x)*r:a.x=u.x+Math.abs(o.x-u.x)*r,o.y<u.y?a.y=u.y-Math.abs(o.y-u.y)*r:a.y=u.y+Math.abs(o.y-u.y)*r,a.x=parseInt(a.x,10),a.y=parseInt(a.y,10),a.x===u.x&&(o.x<u.x?a.x=u.x-1:o.x>u.x&&(a.x=u.x+1)),a.y===u.y&&(o.y<u.y?a.y=u.y-1:o.y>u.y&&(a.y=u.y+1));if(a.x!==o.x||a.y!==o.y)(n.forceGpu===!0||e.config.win.devicePixelRatio>1)&&n.forceGpu!==!1?n.zoomPhotoContainerNode.setStyle("transform","translate3d("+a.x+"px, "+a.y+"px, 0)"):n.zoomPhotoContainerNode.setStyle("transform","translate("+a.x+"px, "+a.y+"px)");n.currentCoords=[a.x,a.y],a.x===o.x&&a.y===o.y&&delete n.pendingCoords}}),this.zoomNode?(this.zoomingOut=!1,r=this.zoomNode,r.removeClass("hiding"),this.detachEventHandlers()):r=this.zoomNode=e.Node.create(this.templates("zoom-modal")({smallSrc:o?s.medium:s.small,largeSrc:u?s.large.url:""})),i=this.zoomPhotoContainerNode=r.one(".zoom-photo-container"),this.zoomImageFullWidth=s.large.width/a,this.zoomImageFullHeight=s.large.height/a,t||(t=[this.appContext.viewportData.viewport.width/2,this.appContext.viewportData.viewport.height/2],n.cursorCoords=t),l=this.getZoomPanCoordsForCursor(t),l=this.constrainPanCoords(l),c={left:l[0],top:l[1],width:this.zoomImageFullWidth,height:this.zoomImageFullHeight},i.setStyle("transition","none"),this.resizeZoomNode(f,!1),r.on("click",function(t){if(n.zoomingIn)return;t.preventDefault(),e.rapidTracker.beacon(n.name,"zoomOutClick"),n.zoomOut()}),e.one("body").append(r),i.setStyle("width",c.width),i.setStyle("height",c.height),e.soon(function(){if(n.zoomingIn){r.removeClass("hidden"),i.setStyle("transition",""),"ontouchstart"in document&&e.use("event-touch",function(){n.touchHandlers=[],n.touchHandlers.push(e.on("touchstart",function(e){e.changedTouches.length&&e.changedTouches.length===1&&(n.touching=[e.changedTouches[0].pageX,e.changedTouches[0].pageY])})),n.touchHandlers.push(e.on("touchmove",function(e){var t=e.pageX,r=e.pageY,i,s;n.touching&&e.changedTouches.length&&e.changedTouches.length===1&&(t=e.changedTouches[0].pageX,r=e.changedTouches[0].pageY,e.preventDefault(),i=t-n.touching[0],s=r-n.touching[1],n.touching=[t,r],n.panZoomNode([n.currentZoomRegion.left+i,n.currentZoomRegion.top+s]))})),n.touchHandlers.push(e.on("touchend",function(e){delete n.touching}))});if(!("ontouchstart"in document)||n.appContext.flipper.isFlipped("enable-always-bind-mouse-events-zoom-view"))r.on("mousemove",n.zoomMouseMoveHandler.bind(n)),n.mouseWheelHandler=function(){var e=n.zoomScrollWheelHandler.bind(n);return h="onwheel"in document.createElement("div")?"wheel":"mousewheel",document.addEventListener(h,e,!1),{detach:function(){document.removeEventListener(h,e,!1)}}}();n.parentViewContainer.addClass("zoomed"),n.resizeZoomNode(c,!0).then(function(){n.zoomingIn&&(n.zoomingIn=!1,n.zoomedIn=!0,n.panZoomNodeToCurrentCoords(),u||i.append('<img src="'+s.large.url+'" class="zoom-large">'))})}})},getDeteriorationRateForEasing:function(){return.2},getZoomPixelRatio:function(){return 1}})},"@VERSION@",{requires:["flickr-view","better-throttle","flickr-promise","hermes-template-zoom","hermes-template-zoom-modal","animation-manager"],optional:["photo-models"],langBundles:["photo-page-scrappy"]});
YUI.add("hermes-template-photo-well-media-scrappy",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o=t!=null?t:{};return'	<div class="restricted-interstitial">\n		<div class="restricted-interstitial-message">\n			<h2>'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADULT_CONTENT"},data:i}))+"</h2>\n"+((s=n["if"].call(o,t!=null?t.isSignedIn:t,{name:"if",hash:{},fn:e.program(2,i,0),inverse:e.program(5,i,0),data:i}))!=null?s:"")+"		</div>\n	</div>\n"},2:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return"				<p>"+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.MATURE_AUDIENCES"},data:i}))+"<br />"+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.USER_DISCRETION"},data:i}))+"</p>\n\n"+((s=n.unless.call(o,t!=null?t.isMinor:t,{name:"unless",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")},3:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return"					<p><button class='ui-button'><span>"+u((n.intlMessage||t&&t.intlMessage||o).call(s,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SHOW_ME_THIS_CONTENT_TYPE"},data:i}))+"</span></button></p>\n					<p>"+u((n.intlHTMLMessage||t&&t.intlHTMLMessage||o).call(s,{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.CHANGE_SAFE_SEARCH_IN_SETTINGS"},data:i}))+"</p>\n"},5:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return"				<p>"+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SIGNED_IN_FOR_CONTENT"},data:i}))+' <a href="//'+a((s=(s=n.host||(t!=null?t.host:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"host",hash:{},data:i}):s))+'/signin/" data-track="photoWellSignInClick">'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:i}))+"</a></p>\n"},7:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.isVideo:t,{name:"if",hash:{},fn:e.program(8,i,0),inverse:e.program(11,i,0),data:i}))!=null?s:""},8:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.isPending:t,{name:"if",hash:{},fn:e.noop,inverse:e.program(9,i,0),data:i}))!=null?s:""},9:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'		<div class="videoplayer main-photo" style="width:'+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+"px; height:"+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+'px;"><video id="video_1" poster="'+f((s=(s=n.src||(t!=null?t.src:t))!=null?s:u,typeof s===a?s.call(o,{name:"src",hash:{},data:i}):s))+'" class="video-js vjs-big-play-centered inherit-size"></video></div>\n'},11:function(e,t,n,r,i){var s;return"\n"+((s=n["if"].call(t!=null?t:{},t!=null?t.showFuzzy:t,{name:"if",hash:{},fn:e.program(12,i,0),inverse:e.program(14,i,0),data:i}))!=null?s:"")},12:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'		<span class="restricted-image main-photo" style="width:'+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+"px;height:"+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+'px;">\n		</span>\n'},14:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'		<span class="facade-of-protection-neue" style="width:'+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+"px;height:"+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+'px;">\n			'+f((n.outlet||t&&t.outlet||u).call(o,t!=null?t["zoom-view"]:t,{name:"outlet",hash:{},data:i}))+"\n			"+f((n.outlet||t&&t.outlet||u).call(o,t!=null?t["vr-overlay-view"]:t,{name:"outlet",hash:{},data:i}))+'\n		</span>\n\n		<img width="'+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+'" height="'+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+'" src="'+f((s=(s=n.src||(t!=null?t.src:t))!=null?s:u,typeof s===a?s.call(o,{name:"src",hash:{},data:i}):s))+'" class="low-res-photo" alt="'+f((s=(s=n.imgAltText||(t!=null?t.imgAltText:t))!=null?s:u,typeof s===a?s.call(o,{name:"imgAltText",hash:{},data:i}):s))+'">\n		<img width="'+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+'" height="'+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+'" src="'+f((s=(s=n.highResSrc||(t!=null?t.highResSrc:t))!=null?s:u,typeof s===a?s.call(o,{name:"highResSrc",hash:{},data:i}):s))+'" class="main-photo is-hidden" onload="registerFirstPhoto(this)" alt="'+f((s=(s=n.imgAltText||(t!=null?t.imgAltText:t))!=null?s:u,typeof s===a?s.call(o,{name:"imgAltText",hash:{},data:i}):s))+'">\n		<noscript>\n			<img width="'+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+'" height="'+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+'" src="'+f((s=(s=n.highResSrc||(t!=null?t.highResSrc:t))!=null?s:u,typeof s===a?s.call(o,{name:"highResSrc",hash:{},data:i}):s))+'" class="main-photo" alt="'+f((s=(s=n.imgAltText||(t!=null?t.imgAltText:t))!=null?s:u,typeof s===a?s.call(o,{name:"imgAltText",hash:{},data:i}):s))+'">\n		</noscript>\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.needsInterstitial:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program
(7,i,0),data:i}))!=null?s:""},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-well-media-scrappy",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-photo-well-ad",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s;return'    <iframe src="'+e.escapeExpression((s=(s=n.iframeSrc||(t!=null?t.iframeSrc:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"iframeSrc",hash:{},data:i}):s))+'" width="970" height="250" border="0" scrolling="no" frameborder="0" marginwidth="0" marginheight="0"></iframe>\n'},3:function(e,t,n,r,i){var s,o,u,a=t!=null?t:{},f=n.helperMissing,l="function",c=n.blockHelperMissing,h="	"+((s=n["if"].call(a,t!=null?t.adFrame:t,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n\n";return s=(o=(o=n.adsTypeB||(t!=null?t.adsTypeB:t))!=null?o:f,u={name:"adsTypeB",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i},typeof o===l?o.call(a,u):o),n.adsTypeB||(s=c.call(t,s,u)),s!=null&&(h+=s),s=(o=(o=n.adsTypeB||(t!=null?t.adsTypeB:t))!=null?o:f,u={name:"adsTypeB",hash:{},fn:e.noop,inverse:e.program(8,i,0),data:i},typeof o===l?o.call(a,u):o),n.adsTypeB||(s=c.call(t,s,u)),s!=null&&(h+=s),h+"\n"+((s=n["if"].call(a,t!=null?t.adFrame:t,{name:"if",hash:{},fn:e.program(10,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"},4:function(e,t,n,r,i){var s;return'<a class="ad-frame" href="'+e.escapeExpression((s=(s=n.clickUrl||(t!=null?t.clickUrl:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"clickUrl",hash:{},data:i}):s))+'" data-track="ad_link_image" target="_blank">'},6:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'	    <div class="ad-wrapper">\n	        <img width=\''+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+"' height='"+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+"' src='"+f((s=(s=n.src||(t!=null?t.src:t))!=null?s:u,typeof s===a?s.call(o,{name:"src",hash:{},data:i}):s))+'\'/>\n	        <a class="ad-footer" href="'+f((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||u).call(o,t!=null?t.clickUrl:t,{name:"renderTrustedMarkup",hash:{},data:i}))+'" data-track="ad_link_bottom" target="_blank">\n	            <h1>'+f((n.intlHTMLMessage||t&&t.intlHTMLMessage||u).call(o,{name:"intlHTMLMessage",hash:{brand:t!=null?t.brand:t,intlName:"photo-page-scrappy.FIND_OUT_MORE_AD"},data:i}))+"</h1>\n	        </a>\n	    </div>\n"},8:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return"	    <img width='"+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+"' height='"+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+"' src='"+f((s=(s=n.src||(t!=null?t.src:t))!=null?s:u,typeof s===a?s.call(o,{name:"src",hash:{},data:i}):s))+"' />\n"},10:function(e,t,n,r,i){return'	<div class="more-info">\n\n		<span><i class="moneyball"></i> '+e.escapeExpression((n.intlHTMLMessage||t&&t.intlHTMLMessage||n.helperMissing).call(t!=null?t:{},{name:"intlHTMLMessage",hash:{brand:t!=null?t.brand:t,intlName:"photo-page-scrappy.FIND_OUT_MORE_AD"},data:i}))+"</span>\n	</div>\n	</a>"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.iframeSrc:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:""},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-well-ad",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-well-media-scrappy-view",function(e,t){var n=require("lib/flog")(t),r=500,i=500,s=40,o;o={photo:{render:function(){var t=this,n=this.get("photo"),r,i,s,o="";return t.preloadImage&&(t.preloadImage.onload=null),this.appContext.forceServerRender?(r=this.getPhotoForDisplay({canvas:{width:Number.MAX_VALUE,height:Number.MAX_VALUE}}),i=r):(r=this.getPhotoForDisplay(),i=this.getPhotoForDisplay({includeSizes:["sq","q","t","s","n"]})),n.getValue("owner")&&(n.getValue("title").trim()===""?o=this.intlMessage({intlName:"common.UNTITLED"}):o=n.getValue("title"),o+=" | "+this.intlMessage({intlName:"common.BY_USER",user:n.getValue("owner").getValue("username")})),s=this.get("container").one(".main-photo"),(!s||parseInt(s.getAttribute("width"),10)!==r.width||parseInt(s.getAttribute("height"),10)!==r.height)&&this.setContainerWithTemplate("photo-well-media-scrappy",{width:r.width,height:r.height,src:i.url,highResSrc:r.url,imgAltText:o,needsInterstitial:n.getValue("needsInterstitial"),isSignedIn:this.appContext.getViewer().signedIn,isVideo:!1,isMinor:this.appContext.getViewer().isMinor}),YUI.Env.isServer?(this.serverWidth=r.width,this.serverHeight=r.height):n.getValue("needsInterstitial")||(t.preloadImage=new Image,t.preloadImage.onload=function(){if(this.onloadFired)return;if(!t.isActiveAndInDOM())return;this.onloadFired=!0;var n,i="photoPageShowedSize",s="\u00f8";try{n=/(?:_([a-z]))?\.jpg/.exec(r.url),n&&n[1]&&(s=n[1])}catch(o){}finally{i+=String(s).toUpperCase()}e.rapidTracker.beacon(this.name,i);var u=t.get("container").one(".low-res-photo"),a=t.get("container").one(".main-photo");a.removeClass("is-hidden").show(),u.hide()},t.preloadImage.src=r.url,t.preloadImage.complete&&t.preloadImage.onload()),this}},video:{render:function(){var e=this.get("photo"),t=this.getPhotoForDisplay({excludeSizes:[]});return!this.player||e.getValue("isVideoPending")?(this.setContainerWithTemplate("photo-well-media-scrappy",{width:t.width,height:t.height,src:t.url,needsInterstitial:e.getValue("needsInterstitial"),isVideo:!0,isSignedIn:this.appContext.getViewer().signedIn,"zoom-view":"",isPending:e.getValue("isVideoPending")}),this):(e.getValue("isVideoPending")||(this.player.dimension?(this.player.dimension("width",t.width),this.player.dimension("height",t.height)):this.player.resize(t.width,t.height)),this)}},ad:{render:function(){var e,t;if(this.iframeSrc){this.setContainerWithTemplate("photo-well-ad",{iframeSrc:this.iframeSrc});return}return this.adJSON?e=this.adJSON:(e=this.appContext.adManager.getAdJSON(),this.adJSON=e),t=this.getAdSize(e),this.setContainerWithTemplate("photo-well-ad",{width:t.width,height:t.height,src:e.url,clickUrl:e.clickUrl,brand:e.brand,adsTypeB:this.appContext.flipper.isFlipped("moneyball-ads-type-b"),adFrame:!0}),this}}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"zoom-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1},"vr-overlay-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,destinationContainer:".photo-well-media-scrappy-view",disabled:function(){return!this.appContext.flipper.isFlipped("enable-vr")}}},initializer:function(e){return this.photoId=e.photoId,this.isAd=!!e.ad,this.iframeSrc=e.iframeSrc,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var t=this;return this.appContext.getModel("photo-models",t.photoId).then(function(n){t.set("photo",n);if(n.getValue("isVideo"))return new e.Promise(function(t,n){e.use("flickr-video-player",function(){t()})})})},buildContainer:function(){return YUI.Env.isServer||this.set("clientRendered",!0),this.isAd?o.ad.render.call(this):o[this.get("photo").getValue("isVideo")?"video":"photo"].render.call(this),!YUI.Env.isServer&&this.subviews["vr-overlay-view"]&&this.subviews["vr-overlay-view"].get("canVr")&&this.subviews["zoom-view"]&&(this.canVR=!0,this.subviews["zoom-view"].destroy({remove:!0})),this.get("photo").getValue("needsInterstitial")?this.get("container").addClass("has-interstitial"):this.get("container").removeClass("has-interstitial"),this},handleInterstitialDismissButtonClick:function(t){var r=this,i=this.get("personPreferences"),s=this.get("photo"),o=s.getValue("safetyLevel");e.rapidTracker.beacon(this.name,"restrictedContentInterstitialClick"),i.setValue("safeSearch",o),i.registry.remoteUpdate(r.appContext.auth.user.nsid).then(function(e){var t=s.registry.attributeSearch({needsInterstitial:!0});t.forEach(function(e){s.registry.getValue(e,"safetyLevel")<=i.getValue("safeSearch")&&s.registry.setValue(e,"needsInterstitial",!1)}),r.buildContainer(),r.fire("subviewViewEvent","photoWellResized")},function(e){n.error({err:e}),r.onError(r.intlMessage({intlName:"photo-page-scrappy.COULDNT_UPDATE_SETTINGS"}))})},onParentViewEvent:function(e,t){t&&t[0]==="photoWellResized"&&(this.get("photo").getValue("needsInterstitial")||(this.set("canvasSizeIsDirty",!0),this.buildContainer()))},activate:function(){var t=this;return this.detectNoPremiumAd(),this.get("photo").getValue("isVideo")&&!this.get("photo").getValue("isVideoPending")&&(t.player=new e.FlickrVideoPlayer({container:t.get("container").one(".videoplayer"),model:t.get("photo"),appContext:t.appContext,videoNode:e.one("#video_1")?e.one("#video_1")._node:null,controlBar:{fullscreenToggle:!1}}),t.player.init().then(function(){}),t.on("destroy",function(){t.player&&(t.player.destroy(),t.player=null)})),this.get("photo").getValue("needsInterstitial")||this.registerEventHandler(e.on("flickr:photo-media-well-update",function(e){t.set("canvasSizeIsDirty",!0),t.buildContainer()})),this.appContext.getViewer().signedIn&&this.appContext.getModel("person-preferences-models",t.appContext.auth.user.nsid).then(function(e){t.set("personPreferences",e),t.get("photo").getValue("needsInterstitial")&&!this.appContext.getViewer().isMinor&&t.get("container").one(".restricted-interstitial-message button")&&t.registerEventHandler(t.get("container").one(".restricted-interstitial-message button"
).on("click",t.handleInterstitialDismissButtonClick,t))}),this},detectNoPremiumAd:function(){var t,n=this;e.config.win.addEventListener("message",function(e){if(!(e&&e.origin.indexOf("//y-flickr.yahoo.com")>-1))return;if(e.data){var t={};e.data.split("&").forEach(function(e){var n=e.split("=");t[n[0]]=n[1],n[0]==="no_ad"&&t.no_ad===n[1]==="true"}),t.no_ad&&(n.iframeSrc=null,n.adJSON=null,n.buildContainer())}})},onError:function(t){var n=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,showBodyLines:!0,showCancelButton:!1,showCancelX:!0,title:this.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:this.intlMessage({intlName:"common.OK"}),message:t,classList:"scrappy-dialog"});n.show()},getPhotoForDisplay:function(e){var t=this.getCanvasSize(),n=this.getPixelRatio(),r,i,s;return e&&e.canvasSize&&(t=e.canvasSize),r=this.get("photo").getSizeToFit(t,e),i=Math.min(t.height/n,r.height),s=Math.min(t.width/n,r.width/r.height*i),i=Math.min(i,r.height/r.width*s),{width:Math.round(s),height:Math.round(i),url:r.url,pixelRatio:r.width/s}},getAdSize:function(e){var t=this.getCanvasSize(),n=this.getPixelRatio(),r=80,i=140,s,o;return this.appContext.flipper.isFlipped("moneyball-ads-type-b")&&(t.height-=(r+i)*n,t.width-=i*n),s=Math.min(t.height/n,e.height),o=Math.min(t.width/n,e.width/e.height*s),s=Math.min(s,e.height/e.width*o),{width:o,height:s}},getCanvasSize:function(){var e,t=this.getPixelRatio(),n,o=this.get("container"),u,a,f,l,c={width:r,height:i};return this.get("canvasSizeIsDirty")?YUI.Env.isServer||(n=this.get("container").ancestor(),u=o.getStyle("paddingTop")?parseInt(o.getStyle("paddingTop").match(/[0-9]+/)[0],10):0,a=o.getStyle("paddingBottom")?parseInt(o.getStyle("paddingBottom").match(/[0-9]+/)[0],10):0,l=s,f=s,n&&(e=n.get("region"),e.height=parseInt(n.getStyle("height").match(/[0-9]+/)[0],10)-(u+a),e.width=this.appContext.viewportData.viewport.width-(l+f))):e=this.get("cachedCanvasSize"),this.appContext.viewportData.viewport.width>0&&(c={width:this.appContext.viewportData.viewport.width,height:this.appContext.viewportData.viewport.height-240}),e||(e={top:0,left:0,bottom:i,right:r,width:c.width,height:c.height}),e.height*=t,e.width*=t,e},getPixelRatio:function(){return this.appContext.getViewer().getPixelRatio()}},{ATTRS:{canvasSizeIsDirty:{value:!0,setter:function(e){return!!e}},cachedCanvasSize:{getter:function(t){return e.merge(t)},setter:function(t){return e.merge(t)}}}})},"@VERSION@",{requires:["flickr-view","moment","vr-overlay-view","zoom-view","hermes-template-photo-well-media-scrappy","hermes-template-photo-well-ad"],optional:["photo-models"],langBundles:["common","photo-page-scrappy"]});
